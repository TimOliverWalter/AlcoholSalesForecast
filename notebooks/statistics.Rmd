---
title: "Statistics"
output: html_notebook
---

```{r}
library(plotly)
library(dplyr)
library(xts)
library(tseries)
```


```{r}
path <- "C:\\__MeineDaten\\EthereumForecast\\data\\alcohol_sales.csv"
df <- read.csv(path, na.strings = c("null", ".", ""))
df <- df %>%
  mutate(Date = as.Date(Date, format = "%Y-%m-%d"))
df
```
```{r}
missing_values <- apply(df,
                        MARGIN = 2,
                        function(x)
                          which(is.na(x)))

if (length(missing_values) == 0) {
  print("No missing values")
} else {
  print("Indexes missing values")
  print(missing_values)
}
```


```{r}
fig <- plot_ly(
  df,
  x = ~ Date,
  y = ~ Sale,
  name = "Sales",
  type = "scatter",
  mode = "lines",
  line = list(color = "rgba(49,130,189,1)")
)

fig <- fig %>%
  layout(
    title = "Alcohol Sales form Jan 1992 to Jan 2019",
    xaxis = list(type = "date"),
    yaxis = list(type = "linear",
                 title = "Sale")
  )

fig
```


```{r}
time_series <- df %>%
  select(Date,
         Sale)

time_series <- xts(time_series$Sale,
                   as.Date(time_series$Date,
                           format = "%Y-%m-%d"))

adft <- adf.test(time_series, k = 14)
print(paste("p-value:", adft$p.value))
```
Data has a unit root, it is a non-stationary.

